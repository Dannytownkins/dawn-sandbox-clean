{% liquid
  assign color_scheme = section.settings.color_scheme
  assign collection = collections[section.settings.collection] | default: collections.all
  assign products_to_show = section.settings.products_to_show | default: 4
  assign layout = section.settings.layout | default: 'grid'
%}

<section
  id="section-{{ section.id }}"
  class="product-showcase-alt color-{{ color_scheme }}"
  style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;"
>
  <div class="page-width">
    {% if section.settings.heading != blank %}
      <div class="product-showcase-alt__header">
        <h2 class="product-showcase-alt__heading">{{ section.settings.heading }}</h2>
        {% if section.settings.description != blank %}
          <div class="product-showcase-alt__description rte">{{ section.settings.description }}</div>
        {% endif %}
      </div>
    {% endif %}

    {% if collection.products.size > 0 %}
      <div class="product-showcase-alt__grid product-showcase-alt__grid--{{ layout }}">
        {% for product in collection.products limit: products_to_show %}
          <div class="product-showcase-alt__item">
            <div class="product-card-minimal">
              {% if product.featured_media %}
                <div class="product-card-minimal__media">
                  <a href="{{ product.url }}" class="product-card-minimal__media-link">
                    {{
                      product.featured_media | image_url: width: 600 | image_tag:
                      loading: 'lazy',
                      alt: product.featured_media.alt | escape,
                      sizes: '(min-width: 990px) 300px, (min-width: 750px) calc((100vw - 130px) / 2), calc((100vw - 50px) / 2)'
                    }}
                  </a>
                </div>
              {% endif %}

              <div class="product-card-minimal__info">
                <h3 class="product-card-minimal__title">
                  <a href="{{ product.url }}">{{ product.title | escape }}</a>
                </h3>

                {% if section.settings.show_vendor and product.vendor != blank %}
                  <div class="product-card-minimal__vendor">{{ product.vendor }}</div>
                {% endif %}

                <div class="product-card-minimal__price">
                  {% render 'price', product: product, price_class: 'price--minimal' %}
                </div>

                {% if section.settings.show_quick_add %}
                  <div class="product-card-minimal__actions">
                    {% if product.available %}
                      <button
                        type="button"
                        class="button button--secondary product-form__cart-submit"
                        data-product-id="{{ product.id }}"
                      >
                        Quick add
                      </button>
                    {% else %}
                      <button type="button" class="button button--secondary" disabled>Sold out</button>
                    {% endif %}
                  </div>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      {% if section.settings.show_view_all and collection.url %}
        <div class="product-showcase-alt__footer">
          <a href="{{ collection.url }}" class="button button--secondary">
            View all {{ collection.title | default: 'products' }}
          </a>
        </div>
      {% endif %}
    {% else %}
      <div class="product-showcase-alt__empty">
        <p>No products found in this collection.</p>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Product Showcase Alt",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured products"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "label": "Products to show",
      "default": 4
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "split",
          "label": "Split"
        }
      ],
      "default": "grid"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_quick_add",
      "label": "Show quick add button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show 'View all' button",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Product Showcase Alt"
    }
  ]
}
{% endschema %}
