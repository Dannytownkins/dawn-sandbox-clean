<div id="nl-modal" class="nl-modal" aria-hidden="true">
  <div class="nl-overlay" data-close></div>
  <div class="nl-dialog" role="dialog" aria-modal="true" aria-labelledby="nl-title">
    <button class="nl-close" type="button" aria-label="Close" data-close>Ã—</button>
    <h3 id="nl-title">10% off your first order</h3>
    <p>Join the list. No spam. Unsubscribe anytime.</p>
    {% form 'customer' %}
      <input type="hidden" name="contact[tags]" value="newsletter">
      <input type="email" name="contact[email]" placeholder="Email address" required style="width:100%;padding:12px;border:1px solid #ddd;border-radius:10px;margin:8px 0;">
      <button type="submit" style="width:100%;min-height:44px;border-radius:12px;background:#111;color:#fff;border:1px solid #111;">Subscribe</button>
    {% endform %}
  </div>
  <style>
    .nl-modal[aria-hidden="true"]{display:none}
    .nl-modal{position:fixed;inset:0;z-index:80}
    .nl-overlay{position:absolute;inset:0;background:rgba(0,0,0,.45)}
    .nl-dialog{position:relative;max-width:420px;margin:8vh auto;background:#fff;border-radius:18px;padding:22px;box-shadow:0 20px 60px rgba(0,0,0,.25)}
    .nl-close{position:absolute;top:10px;right:12px;background:#f2f2f2;border:none;border-radius:999px;width:32px;height:32px;font-size:18px;cursor:pointer}
    @media (max-width: 520px){ .nl-dialog{margin:6vh 14px;} }
  </style>
  <script>
  (function(){
    var KEY='nl_seen_until_v1';
    function seen(){ var v=localStorage.getItem(KEY); return v && Date.now() < parseInt(v,10); }
    function setSeen(days){ localStorage.setItem(KEY, String(Date.now()+days*24*3600*1000)); }
    function open(){ if(seen()) return; el.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
    function close(){ el.setAttribute('aria-hidden','true'); document.body.style.overflow=''; setSeen(7); }
    var el=document.getElementById('nl-modal'); if(!el || seen()) return;
    setTimeout(open, 15000);  // time-on-site
    document.addEventListener('mouseleave', function(e){ if(e.clientY<=0) open(); }, {once:true}); // exit intent
    el.querySelectorAll('[data-close]').forEach(function(n){ n.addEventListener('click', close); });
    document.addEventListener('keydown', function(e){ if(e.key==='Escape') close(); });
  })();
  </script>
</div>
